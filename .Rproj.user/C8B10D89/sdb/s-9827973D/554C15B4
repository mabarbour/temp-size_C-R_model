{
    "contents" : "######################################################\n## Description: This script simulates the direct and indirect (via body size) effects of temperature on consumer-resource dynamics\n## Code author(s): Matt Barbour\n## Email: barbour@zoology.ubc.ca\n######################################################\n\n## load required libraries ----\nlibrary(deSolve)\n\n## functions for simulating consumer-resource dynamics ----\n# general assumptions:\n# (1) logistic growth for the resource(s)\n# (2) type 1 functional response of consumer \n# (3) density-independent mortality for consumer \n# function is in the necessary format \"function(t,y,p)\" for solving used the ode() function in the R package \"deSolve\"\nrmcr_tempsize <- function(t,y,p) {\n  # t,y,p is the necessary format for solving using the ode() function in R\n  R <- y[1]\n  C <- y[2]\n  with(as.list(p), {\n    dR.dt <- rMT * R * (1 - R / KMT) - aMT * C * R \n    dC.dt <- eM * aMT * C * R - mMT * C # assuming e is independent of temperature, Peters 1983, but depends on body size which is indirectly affected by temperature...\n    return(list(c(dR.dt,dC.dt)))\n  })\n}\n\n## function for plotting consumer-resource dynamics over time ----\ndynamic_matplot <- function(param.vector, # vector of parameters for the dynamical model\n                            init.state, # initial state variables for the model\n                            sim.length, # length of simulation\n                            model, # dynamical model\n                            ylim, # limits of state variables for plotting\n                            ...){\n  \n  # Run the experiment\n  df <- ode(init.state, 1:sim.length, model, param.vector)\n  \n  # plot the results. \n  matplot(df[ ,\"time\"], df[ ,names(init.state)],\n          type = \"l\", ylim=ylim, ...)\n}\n\n## temperature-dependent parameters ----\n# from Gilbert et al. 2014, Ecol. Letts.\nrT <- exp(-EB/k*TR) \nKT <- K0*exp(EB/k*TR - ES/k*TS) # delta K is thought to be less than 1 (Kratina et al. 2012, aquatic microcosms; Roemmich and McGowan 1995, marine)\nmT <- m0*exp(-Em/k*TC) \naT <- a0*sqrt(( v0C^2 * exp(-2*EvC/k*TC) + v0R^2 * exp(-2*EvR/k*TR ))) # dependent on type of foragin interaction (Dell et al. 2013). For example, active-capture depends on body velocity of both consumer and resource, sit-and-wait depends primarily on body velocity of resource, grazing depends primarily on body velocity of consumer\n\n## mass-dependent parameters ----\n# from DeLong et al. 2015, Am. Nat.\nrM <- r0*MR^s.r \nKM <- K0*MR^s.K\naM <- a0*MC^s.a\neM <- e0*MC^s.e\n\n## effects of temperature on average adult body size ----\n# don't know if it is accurate that I want to be calculating the change in temperature because I don't have the change in temperature anywhere else in the model...\n# need help writing this function\nMR <- M0R + bR*M0R*(TR - T0R) # function needs to be fine tuned. (TR - T0R) describes change in temperature; M0R is baseline adult body size; bR is the slope of the relationship between adult body size and temperature\nMC <- M0C + bC*M0C*(TC - T0C) # function needs to be fine tuned, see above notes.\n\n## combining temperature- and mass-dependent parameters ----\nrMT <- r0*(MR^s.r)*exp(-EB/k*TR)\nKMT <- K0*(MR^s.K)*exp(EB/k*TR - ES/k*TS)\naMT <- a0*(MC^s.a)*exp(-Em/k*TC)\neM # no appartent direct effect of temperature...but now, it appears there could be an indirect effect of temperature mediated by changes in body size\n\n## temperature-independent parameters ----\n## base parameters\nr0 <- 2 # intrinsic growth rate; From Gilbert et al. 2014, Fig. 3 legend\ne0 <- 0.15 # conversion efficiency; From Gilbert et al. 2014, Fig. 3 legend\nK0 <- 100 # carrying capacity; From Gilbert et al. 2014, Fig. 3 legend\na0 <- 0.1 # attack rate; From Gilbert et al. 2014, Fig. 3 legend \nm0 <- 0.6 # mortality rate; From Gilbert et al. 2014, Fig. 3 legend\n\n## activation energies\nEB <- 0.32 # activation energy of the metabolic rate; EB = 0.53 - 0.85 Savage et al. 2004, diverse ectotherms; exact value from Gilbert et al. 2014, Fig. 3 legend\nEm <- 0.65 # activation energy of mortality rate; Em = 0.65 Dell et al. 2011 across diverse taxa; Em = 0.45 Savage et al. 2004 for fish\nES <- 0.9 # activation energy of nutrient supply. From Gilbert et al. 2014, Fig. 3 legend\nEvC <- 0.46 # activation energy of consumer velocity. 0.46 corresponds to the mean activatiaion energy for body velocity across diverse taxa and trophic groups Dell et al. 2014, J. Animal Ecology.\nEvR <- 0.46 # activation energy of resource velocity. 0.46 corresponds to the mean activatiaion energy for body velocity across diverse taxa and trophic groups Dell et al. 2014, J. Animal Ecology.\n\n## other parameters. Note that if body velocities for consumers and resources are about equal, then this represents an active-capture foraging strategy.\nv0C <- 1 # consumer body velocity. arbitratily set to 1\nv0R <- 1 # resource body velocity. arbitrarily set to 1\nk <- 8.62*10^-5 # Boltzmann's constant in eV/K, where K is temperature in Kelvin\n\n## temperatures. assuming they are all the same for right now\nTR <- 15 # body temperature of resource in C, but don't I need it in Kelvin to be consistent with Boltmann's constant\nTC <- TR # body temperature of consumer in C\nTS <- TC <- TR # temperature of supply rate? in C\n\n## exponents for mass-scaling. From DeLong et al. 2015, Am. Nat. Table 1 which was for a protist consumer and algae resource\ns.r <- -0.2 # mass-scaling for intrinsic growth rate\ns.K <- -0.81 # mass-scaling for carrying capacity\ns.a <- 1 # mass-scaling for attack rate\ns.e <- -0.50 # mass-scaling for conversion efficiency\ns.m <- -0.29 # mass-scaling for mortality rate\n\n## parameters for calculating changes in size due to increasing temperature.\nbR # \nbC #\nM0R #\nM0C #",
    "created" : 1462392650909.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "6|27|7|16|\n9|55|24|1|\n6|34|15|0|\n26|62|40|1|\n42|36|47|333|\n49|29|54|15|\n56|53|60|81|\n62|56|66|150|\n68|38|104|5|\n",
    "hash" : "2515930867",
    "id" : "554C15B4",
    "lastKnownWriteTime" : 1462401210,
    "path" : "~/Documents/temp-size_C-R_model/temp_size_C-R_model.R",
    "project_path" : "temp_size_C-R_model.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}